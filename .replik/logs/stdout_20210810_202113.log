running...

0it [00:00, ?it/s]
  0%|          | 0/169001437 [00:00<?, ?it/s]
  0%|          | 8192/169001437 [00:00<35:58, 78289.95it/s]
  0%|          | 40960/169001437 [00:00<13:22, 210438.96it/s]
  0%|          | 90112/169001437 [00:00<08:45, 321447.05it/s]
  0%|          | 204800/169001437 [00:00<04:36, 610722.63it/s]
  0%|          | 417792/169001437 [00:00<02:33, 1098266.72it/s]
  1%|          | 860160/169001437 [00:01<01:19, 2105348.89it/s]
  1%|          | 1728512/169001437 [00:01<00:41, 4021700.24it/s]
  2%|▏         | 3481600/169001437 [00:01<00:21, 7833611.34it/s]
  4%|▎         | 6168576/169001437 [00:01<00:12, 13117111.65it/s]
  5%|▌         | 8740864/169001437 [00:01<00:09, 16342883.79it/s]
  6%|▌         | 10559488/169001437 [00:01<00:10, 15321503.42it/s]
  8%|▊         | 13639680/169001437 [00:01<00:08, 18961198.30it/s]
  9%|▉         | 15556608/169001437 [00:01<00:08, 18627810.54it/s]
 11%|█         | 18653184/169001437 [00:01<00:07, 21470757.89it/s]
 13%|█▎        | 21782528/169001437 [00:02<00:06, 23642928.48it/s]
 14%|█▍        | 24272896/169001437 [00:02<00:06, 23395531.32it/s]
 16%|█▌        | 27402240/169001437 [00:02<00:05, 24978516.45it/s]
 18%|█▊        | 30547968/169001437 [00:02<00:05, 26019566.33it/s]
 20%|█▉        | 33366016/169001437 [00:02<00:05, 25868020.02it/s]
 22%|██▏       | 36478976/169001437 [00:02<00:04, 26672207.25it/s]
 23%|██▎       | 39624704/169001437 [00:02<00:04, 27191442.47it/s]
 25%|██▌       | 42352640/169001437 [00:02<00:04, 26607311.84it/s]
 27%|██▋       | 45146112/169001437 [00:02<00:04, 26351711.49it/s]
 29%|██▊       | 48291840/169001437 [00:03<00:04, 26986976.03it/s]
 30%|███       | 51404800/169001437 [00:03<00:04, 27538412.94it/s]
 32%|███▏      | 54501376/169001437 [00:03<00:04, 28494390.86it/s]
 34%|███▍      | 57614336/169001437 [00:03<00:03, 28501670.52it/s]
 36%|███▌      | 60473344/169001437 [00:03<00:04, 26691873.60it/s]
 38%|███▊      | 63479808/169001437 [00:03<00:03, 26983477.68it/s]
 39%|███▉      | 66199552/169001437 [00:03<00:03, 26171514.79it/s]
 41%|████      | 68829184/169001437 [00:03<00:03, 25583820.46it/s]
 43%|████▎     | 71868416/169001437 [00:03<00:03, 26296656.02it/s]
 44%|████▍     | 74997760/169001437 [00:04<00:03, 26990848.04it/s]
 46%|████▌     | 78110720/169001437 [00:04<00:03, 27449599.48it/s]
 48%|████▊     | 81223680/169001437 [00:04<00:03, 27757361.49it/s]
 50%|████▉     | 84008960/169001437 [00:04<00:03, 27069261.86it/s]
 51%|█████▏    | 86941696/169001437 [00:04<00:03, 26863102.24it/s]
 53%|█████▎    | 90087424/169001437 [00:04<00:02, 27227645.84it/s]
 55%|█████▌    | 93216768/169001437 [00:04<00:02, 27847723.70it/s]
 57%|█████▋    | 96346112/169001437 [00:04<00:02, 28092466.36it/s]
 59%|█████▊    | 99164160/169001437 [00:04<00:02, 27317109.64it/s]
 60%|██████    | 102178816/169001437 [00:04<00:02, 27399359.10it/s]
 62%|██████▏   | 105291776/169001437 [00:05<00:02, 27735720.91it/s]
 64%|██████▍   | 108068864/169001437 [00:05<00:02, 26907250.47it/s]
 66%|██████▌   | 110944256/169001437 [00:05<00:02, 26461688.60it/s]
 67%|██████▋   | 114040832/169001437 [00:05<00:02, 26895892.48it/s]
 69%|██████▉   | 117170176/169001437 [00:05<00:01, 27280654.43it/s]
 71%|███████   | 120283136/169001437 [00:05<00:01, 27645661.80it/s]
 73%|███████▎  | 123363328/169001437 [00:05<00:01, 27764897.31it/s]
 75%|███████▍  | 126148608/169001437 [00:05<00:01, 27698942.36it/s]
 76%|███████▋  | 128925696/169001437 [00:05<00:01, 26651428.14it/s]
 78%|███████▊  | 131768320/169001437 [00:06<00:01, 26720653.62it/s]
 80%|███████▉  | 134447104/169001437 [00:06<00:01, 26137516.58it/s]
 81%|████████▏ | 137338880/169001437 [00:06<00:01, 26217282.90it/s]
 83%|████████▎ | 140042240/169001437 [00:06<00:01, 25656539.97it/s]
 85%|████████▍ | 143155200/169001437 [00:06<00:00, 26532692.36it/s]
 86%|████████▋ | 145874944/169001437 [00:06<00:00, 26699241.86it/s]
 88%|████████▊ | 148987904/169001437 [00:06<00:00, 27480282.65it/s]
 90%|████████▉ | 152100864/169001437 [00:06<00:00, 27768869.12it/s]
 92%|█████████▏| 155197440/169001437 [00:06<00:00, 27204243.91it/s]
 94%|█████████▎| 158310400/169001437 [00:07<00:00, 28250179.71it/s]
 96%|█████████▌| 161439744/169001437 [00:07<00:00, 28368803.01it/s]
 97%|█████████▋| 164290560/169001437 [00:07<00:00, 28347088.85it/s]
 99%|█████████▉| 167133184/169001437 [00:07<00:00, 27681582.26it/s]
169009152it [00:10, 16132723.22it/s]                               
Downloading: "https://download.pytorch.org/models/resnet18-5c106cde.pth" to /home/user/.cache/torch/checkpoints/resnet18-5c106cde.pth

  0%|          | 0.00/44.7M [00:00<?, ?B/s]
 11%|█▏        | 5.13M/44.7M [00:00<00:00, 53.8MB/s]
 24%|██▍       | 10.7M/44.7M [00:00<00:00, 55.8MB/s]
 36%|███▌      | 16.0M/44.7M [00:00<00:00, 50.6MB/s]
 47%|████▋     | 20.9M/44.7M [00:00<00:00, 51.0MB/s]
 62%|██████▏   | 27.6M/44.7M [00:00<00:00, 57.5MB/s]
 74%|███████▍  | 33.1M/44.7M [00:00<00:00, 54.8MB/s]
 86%|████████▌ | 38.4M/44.7M [00:00<00:00, 50.2MB/s]
 99%|█████████▉| 44.1M/44.7M [00:00<00:00, 52.9MB/s]
100%|██████████| 44.7M/44.7M [00:00<00:00, 53.2MB/s]Files already downloaded and verified
Files already downloaded and verified
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to $/home/group-cvg/cvg-students/vella/data/cifar-100-python.tar.gz
Extracting $/home/group-cvg/cvg-students/vella/data/cifar-100-python.tar.gz to $/home/group-cvg/cvg-students/vella/data/
CIFAT10 START

im using:cuda:0
Epoch 0/24
----------

Loss: 1.6478 Acc: 0.3877 Uncertainty_mean: 0.5412 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.9463 Acc: 0.6649 Uncertainty_mean: 0.6118 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.6838 Acc: 0.7633 Uncertainty_mean: 0.6687 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.5534 Acc: 0.8083 Uncertainty_mean: 0.5888 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.4569 Acc: 0.8417 Uncertainty_mean: 0.6137 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.3690 Acc: 0.8737 Uncertainty_mean: 0.6053 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.2950 Acc: 0.8969 Uncertainty_mean: 0.5632 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.2270 Acc: 0.9197 Uncertainty_mean: 0.6572 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.1829 Acc: 0.9347 Uncertainty_mean: 0.5446 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.1471 Acc: 0.9483 Uncertainty_mean: 0.5642 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.1237 Acc: 0.9563 Uncertainty_mean: 0.5320 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.1113 Acc: 0.9608 Uncertainty_mean: 0.5454 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0941 Acc: 0.9680 Uncertainty_mean: 0.5295 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0876 Acc: 0.9689 Uncertainty_mean: 0.5125 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0820 Acc: 0.9719 Uncertainty_mean: 0.5834 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0788 Acc: 0.9733 Uncertainty_mean: 0.5218 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0701 Acc: 0.9758 Uncertainty_mean: 0.5713 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0599 Acc: 0.9794 Uncertainty_mean: 0.5198 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.0609 Acc: 0.9788 Uncertainty_mean: 0.4957 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.0552 Acc: 0.9809 Uncertainty_mean: 0.5216 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.0529 Acc: 0.9818 Uncertainty_mean: 0.5037 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.0525 Acc: 0.9814 Uncertainty_mean: 0.5047 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.0455 Acc: 0.9843 Uncertainty_mean: 0.5518 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.0492 Acc: 0.9835 Uncertainty_mean: 0.5181 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.0413 Acc: 0.9851 Uncertainty_mean: 0.5381 
Saved: ./results/models/ResNet18CIFAR10_crossEntropyPretrained/24.pth

Training complete in 48m 35s
Best Acc: 0.985120 Best Uncertainty: 0.495699
Loading model ./results/models/ResNet18CIFAR10_crossEntropyPretrained/00.pth
Traceback (most recent call last):
  File "codebase/main.py", line 272, in <module>
    main()
  File "codebase/main.py", line 269, in main
    runExperiments()
  File "codebase/main.py", line 265, in runExperiments
    trainEvalCIFAR10(train =True, criterion_name ="crossEntropy")
  File "codebase/main.py", line 97, in trainEvalCIFAR10
    defineExperiment(modelList, criterion_name=criterion_name, optimizer=optimizer, train_dataloader=dataloaders["CIFAR10_TRAIN"], num_train_classes =10 , test_dataloader=dataloaders["CIFAR10_TEST"], num_test_classes=10 ,train=train, pretrained =True, num_epochs = 25, uncertaintyThreshold = -0.1)
  File "codebase/main.py", line 88, in defineExperiment
    val_acc_hist, uncertainty_histry = eval_model(modelList, test_dataloader, model_directory ,device, num_classes = num_test_classes, hierarchicalModelPathList =hierarchicalModelPathList , train_dataloader= train_dataloader , test_dataloader =test_dataloader)
  File "/home/user/experiments/codebase/eval.py", line 178, in eval_model
    inputs, labels, outputs, preds, running_corrects, u, u_mean, epoch_acc, epoch_uncertainty,  correctWhileStaySuper, correctWhileLeaveSuper, falseWhileStaySuper ,falseWhileLeaveSuper = calculate_results()
  File "/home/user/experiments/codebase/eval.py", line 148, in calculate_results
    u_list = u_list.append(u)
UnboundLocalError: local variable 'u_list' referenced before assignment
