running...
Downloading: "https://download.pytorch.org/models/resnet18-5c106cde.pth" to /home/user/.cache/torch/checkpoints/resnet18-5c106cde.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 10%|▉         | 4.45M/44.7M [00:00<00:00, 46.6MB/s] 25%|██▍       | 11.0M/44.7M [00:00<00:00, 59.3MB/s] 38%|███▊      | 16.8M/44.7M [00:00<00:00, 59.8MB/s] 54%|█████▍    | 24.3M/44.7M [00:00<00:00, 67.3MB/s] 69%|██████▉   | 30.7M/44.7M [00:00<00:00, 60.0MB/s] 84%|████████▍ | 37.6M/44.7M [00:00<00:00, 63.9MB/s]100%|█████████▉| 44.4M/44.7M [00:00<00:00, 66.2MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 63.4MB/s]Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
COARSE START

im using:cuda:0
Epoch 0/24
----------

Loss: 1.0576 Acc: 0.6604 Uncertainty_mean: 0.7962 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.5976 Acc: 0.8041 Uncertainty_mean: 0.7642 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.4295 Acc: 0.8579 Uncertainty_mean: 0.7427 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.2988 Acc: 0.9016 Uncertainty_mean: 0.7546 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.1985 Acc: 0.9337 Uncertainty_mean: 0.7503 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.1313 Acc: 0.9561 Uncertainty_mean: 0.7138 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.0869 Acc: 0.9715 Uncertainty_mean: 0.7009 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.0627 Acc: 0.9801 Uncertainty_mean: 0.7542 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.0529 Acc: 0.9827 Uncertainty_mean: 0.7735 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.0428 Acc: 0.9857 Uncertainty_mean: 0.6677 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.0363 Acc: 0.9879 Uncertainty_mean: 0.6796 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.0314 Acc: 0.9895 Uncertainty_mean: 0.6232 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0293 Acc: 0.9900 Uncertainty_mean: 0.6689 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0280 Acc: 0.9908 Uncertainty_mean: 0.6085 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0243 Acc: 0.9917 Uncertainty_mean: 0.6308 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0263 Acc: 0.9912 Uncertainty_mean: 0.6326 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0231 Acc: 0.9919 Uncertainty_mean: 0.6025 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0218 Acc: 0.9926 Uncertainty_mean: 0.6495 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.0212 Acc: 0.9926 Uncertainty_mean: 0.6306 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.0195 Acc: 0.9934 Uncertainty_mean: 0.6981 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.0231 Acc: 0.9925 Uncertainty_mean: 0.6227 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.0208 Acc: 0.9930 Uncertainty_mean: 0.6363 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.0189 Acc: 0.9938 Uncertainty_mean: 0.5729 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.0214 Acc: 0.9929 Uncertainty_mean: 0.6099 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.0192 Acc: 0.9937 Uncertainty_mean: 0.7136 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth

Training complete in 49m 26s
Best Acc: 0.993800 Best Uncertainty: 0.572870
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7841
Uncertainty: 0.7382311820983887
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8130
Uncertainty: 0.735389769077301
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8225
Uncertainty: 0.7291194200515747
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8283
Uncertainty: 0.6913793683052063
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8431
Uncertainty: 0.6971348524093628
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8372
Uncertainty: 0.6826149821281433
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8388
Uncertainty: 0.6647396087646484
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8369
Uncertainty: 0.6436806917190552
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8315
Uncertainty: 0.6220757961273193
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8349
Uncertainty: 0.6129439473152161
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8338
Uncertainty: 0.5976628065109253
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8356
Uncertainty: 0.585145890712738
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8319
Uncertainty: 0.5780373811721802
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8456
Uncertainty: 0.6088347434997559
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth
Saved the best model by Accuracy after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth 

Saved the best model by Uncertainty after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth 

Best Acc: 0.845600 Best uncertainty_mean: 0.5780373811721802 


Validation complete in 4m 33s
COARSE END

FINE START

im using:cuda:0
Epoch 0/24
----------
Loss: 1.7217 Acc: 0.5408 Uncertainty_mean: 0.9554 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.8876 Acc: 0.7322 Uncertainty_mean: 0.9526 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.6482 Acc: 0.7976 Uncertainty_mean: 0.9358 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.4768 Acc: 0.8481 Uncertainty_mean: 0.9290 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.3479 Acc: 0.8885 Uncertainty_mean: 0.9485 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.2434 Acc: 0.9219 Uncertainty_mean: 0.9426 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.1708 Acc: 0.9458 Uncertainty_mean: 0.9413 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.1193 Acc: 0.9632 Uncertainty_mean: 0.9431 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.0903 Acc: 0.9734 Uncertainty_mean: 0.9428 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.0696 Acc: 0.9790 Uncertainty_mean: 0.9510 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.0574 Acc: 0.9827 Uncertainty_mean: 0.9469 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Traceback (most recent call last):
  File "codebase/main.py", line 271, in <module>
    main()
  File "codebase/main.py", line 268, in main
    runExperiments()
  File "codebase/main.py", line 264, in runExperiments
    CIFAR100_coarse_AND_fine(train =True, criterion_name ="crossEntropy")
  File "codebase/main.py", line 117, in CIFAR100_coarse_AND_fine
    defineExperiment(modelList, criterion_name=criterion_name, optimizer=optimizer, train_dataloader=dataloaders["CIFAR100_fine_labels_TRAIN"], num_train_classes =100 , test_dataloader=dataloaders["CIFAR100_fine_labels_TEST"], num_test_classes=100 ,train=train, pretrained =True, num_epochs =25, uncertaintyThreshold = -0.1)
  File "codebase/main.py", line 78, in defineExperiment
    train_acc_hist, train_loss_hist , train_uncertainty_hist = train_model(model, train_dataloader, num_classes =num_train_classes, criterion= criterion, optimizer=optimizer, model_directory= model_directory, device=device , num_epochs=num_epochs, uncertainty=uncertainty)
  File "/home/user/experiments/codebase/train.py", line 67, in train_model
    running_loss += loss.item() * inputs.size(0)
KeyboardInterrupt
