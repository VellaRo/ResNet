running...
Downloading: "https://download.pytorch.org/models/resnet18-5c106cde.pth" to /home/user/.cache/torch/checkpoints/resnet18-5c106cde.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 10%|█         | 4.52M/44.7M [00:00<00:00, 47.3MB/s] 29%|██▉       | 13.1M/44.7M [00:00<00:00, 72.2MB/s] 54%|█████▍    | 24.1M/44.7M [00:00<00:00, 92.2MB/s] 79%|███████▉  | 35.3M/44.7M [00:00<00:00, 102MB/s] 100%|██████████| 44.7M/44.7M [00:00<00:00, 77.6MB/s]Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
COARSE START

im using:cuda:0
Epoch 0/24
----------

Loss: 1.0935 Acc: 0.6529 Uncertainty_mean: 0.8382 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.6512 Acc: 0.7892 Uncertainty_mean: 0.7892 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.4773 Acc: 0.8447 Uncertainty_mean: 0.8046 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.3429 Acc: 0.8849 Uncertainty_mean: 0.7240 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.2491 Acc: 0.9155 Uncertainty_mean: 0.7680 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.1821 Acc: 0.9380 Uncertainty_mean: 0.7637 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.1368 Acc: 0.9518 Uncertainty_mean: 0.7576 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.1072 Acc: 0.9623 Uncertainty_mean: 0.7623 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.0940 Acc: 0.9689 Uncertainty_mean: 0.7624 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.0772 Acc: 0.9734 Uncertainty_mean: 0.6727 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.0724 Acc: 0.9758 Uncertainty_mean: 0.7015 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.0676 Acc: 0.9770 Uncertainty_mean: 0.6912 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0649 Acc: 0.9793 Uncertainty_mean: 0.7501 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0565 Acc: 0.9815 Uncertainty_mean: 0.7650 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0536 Acc: 0.9826 Uncertainty_mean: 0.6572 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0511 Acc: 0.9834 Uncertainty_mean: 0.6841 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0491 Acc: 0.9843 Uncertainty_mean: 0.6572 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0459 Acc: 0.9855 Uncertainty_mean: 0.6791 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.0466 Acc: 0.9854 Uncertainty_mean: 0.6568 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.0449 Acc: 0.9864 Uncertainty_mean: 0.6509 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.0428 Acc: 0.9868 Uncertainty_mean: 0.6101 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.0392 Acc: 0.9875 Uncertainty_mean: 0.6570 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.0397 Acc: 0.9874 Uncertainty_mean: 0.6577 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.0399 Acc: 0.9880 Uncertainty_mean: 0.6438 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.0379 Acc: 0.9883 Uncertainty_mean: 0.6986 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth

Training complete in 53m 37s
Best Acc: 0.988260 Best Uncertainty: 0.610112
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7702
Uncertainty: 0.7688612341880798
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8196
Uncertainty: 0.7619008421897888
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8247
Uncertainty: 0.753301739692688
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8353
Uncertainty: 0.7432994246482849
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8365
Uncertainty: 0.7372179627418518
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8352
Uncertainty: 0.7334145903587341
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8370
Uncertainty: 0.7201319932937622
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8389
Uncertainty: 0.7081553339958191
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8350
Uncertainty: 0.6882461905479431
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8367
Uncertainty: 0.6776467561721802
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8386
Uncertainty: 0.6784507632255554
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8394
Uncertainty: 0.6789538860321045
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8412
Uncertainty: 0.6705146431922913
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8428
Uncertainty: 0.6829479336738586
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8440
Uncertainty: 0.6737655401229858
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth
Saved the best model by Accuracy after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth 

Saved the best model by Uncertainty after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth 

Best Acc: 0.844000 Best uncertainty_mean: 0.6397342085838318 


Validation complete in 4m 18s
COARSE END

FINE START

im using:cuda:0
Epoch 0/24
----------
Loss: 1.7055 Acc: 0.5388 Uncertainty_mean: 0.9672 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.9627 Acc: 0.7152 Uncertainty_mean: 0.9456 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.7240 Acc: 0.7771 Uncertainty_mean: 0.9753 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.5550 Acc: 0.8258 Uncertainty_mean: 0.9738 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.4105 Acc: 0.8682 Uncertainty_mean: 0.9719 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.3050 Acc: 0.8984 Uncertainty_mean: 0.9767 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.2341 Acc: 0.9222 Uncertainty_mean: 0.9732 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.1839 Acc: 0.9380 Uncertainty_mean: 0.9709 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.1466 Acc: 0.9504 Uncertainty_mean: 0.9645 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.1266 Acc: 0.9575 Uncertainty_mean: 0.9731 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.1063 Acc: 0.9644 Uncertainty_mean: 0.9723 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.0918 Acc: 0.9695 Uncertainty_mean: 0.9554 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0871 Acc: 0.9705 Uncertainty_mean: 0.9597 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0791 Acc: 0.9735 Uncertainty_mean: 0.9795 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0708 Acc: 0.9767 Uncertainty_mean: 0.9804 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0687 Acc: 0.9772 Uncertainty_mean: 0.9772 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0648 Acc: 0.9792 Uncertainty_mean: 0.9484 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0647 Acc: 0.9787 Uncertainty_mean: 0.9654 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.0577 Acc: 0.9814 Uncertainty_mean: 0.9615 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.0617 Acc: 0.9808 Uncertainty_mean: 0.9707 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.0546 Acc: 0.9835 Uncertainty_mean: 0.9588 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.0573 Acc: 0.9824 Uncertainty_mean: 0.9609 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.0521 Acc: 0.9834 Uncertainty_mean: 0.9501 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.0505 Acc: 0.9841 Uncertainty_mean: 0.9676 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.0511 Acc: 0.9848 Uncertainty_mean: 0.9406 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/24.pth

Training complete in 53m 41s
Best Acc: 0.984800 Best Uncertainty: 0.940613
Loading model ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/00.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.6891
Uncertainty: 0.9522247910499573
Loading model ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/01.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7345
Uncertainty: 0.9503489136695862
Loading model ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/02.pth
Loading model ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/03.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7568
Uncertainty: 0.9530072212219238
Loading model ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/04.pth
Traceback (most recent call last):
  File "codebase/main.py", line 284, in <module>
    main()
  File "codebase/main.py", line 281, in main
    runExperiments()
  File "codebase/main.py", line 274, in runExperiments
    CIFAR100_coarse_AND_fine(train =True, criterion_name ="crossEntropy")
  File "codebase/main.py", line 126, in CIFAR100_coarse_AND_fine
    defineExperiment(modelList, criterion_name=criterion_name, optimizer=optimizer, train_dataloader=dataloaders["CIFAR100_fine_labels_TRAIN"], num_train_classes =100 , test_dataloader=dataloaders["CIFAR100_fine_labels_TEST"], num_test_classes=100 ,train=train, pretrained =True, num_epochs =25, uncertaintyThreshold = -0.1)
  File "codebase/main.py", line 89, in defineExperiment
    val_acc_hist, uncertainty_histry = eval_model(modelList, test_dataloader, model_directory ,device, num_classes = num_test_classes, hierarchicalModelPathList =hierarchicalModelPathList , train_dataloader= train_dataloader , test_dataloader =test_dataloader)
  File "/home/user/experiments/codebase/eval.py", line 189, in eval_model
    
  File "/home/user/experiments/codebase/eval.py", line 122, in calculate_results
    labels = labels.to(device)  
KeyboardInterrupt
