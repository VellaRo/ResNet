running...
Downloading: "https://download.pytorch.org/models/resnet18-5c106cde.pth" to /home/user/.cache/torch/checkpoints/resnet18-5c106cde.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 10%|█         | 4.51M/44.7M [00:00<00:00, 47.3MB/s] 20%|██        | 9.02M/44.7M [00:00<00:00, 47.1MB/s] 30%|███       | 13.5M/44.7M [00:00<00:00, 45.5MB/s] 41%|████▏     | 18.5M/44.7M [00:00<00:00, 47.6MB/s] 53%|█████▎    | 23.9M/44.7M [00:00<00:00, 50.6MB/s] 68%|██████▊   | 30.2M/44.7M [00:00<00:00, 55.8MB/s] 83%|████████▎ | 37.1M/44.7M [00:00<00:00, 61.0MB/s] 97%|█████████▋| 43.5M/44.7M [00:00<00:00, 62.9MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 56.5MB/s]Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
COARSE START

im using:cuda:0
Epoch 0/24
----------

Loss: 2.0176 Acc: 0.4261 Uncertainty_mean: 0.8520 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 1.2415 Acc: 0.6182 Uncertainty_mean: 0.8262 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 1.0157 Acc: 0.6779 Uncertainty_mean: 0.8233 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.8961 Acc: 0.7110 Uncertainty_mean: 0.7731 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.8146 Acc: 0.7347 Uncertainty_mean: 0.7809 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.7531 Acc: 0.7555 Uncertainty_mean: 0.8050 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.7056 Acc: 0.7692 Uncertainty_mean: 0.7871 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.6636 Acc: 0.7838 Uncertainty_mean: 0.8092 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.6297 Acc: 0.7933 Uncertainty_mean: 0.7924 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.5930 Acc: 0.8048 Uncertainty_mean: 0.7785 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.5637 Acc: 0.8163 Uncertainty_mean: 0.7955 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.5351 Acc: 0.8244 Uncertainty_mean: 0.7428 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.5157 Acc: 0.8329 Uncertainty_mean: 0.7681 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.4900 Acc: 0.8396 Uncertainty_mean: 0.8080 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.4671 Acc: 0.8474 Uncertainty_mean: 0.7647 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.4470 Acc: 0.8535 Uncertainty_mean: 0.8210 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.4272 Acc: 0.8600 Uncertainty_mean: 0.7872 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.4065 Acc: 0.8669 Uncertainty_mean: 0.8141 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.3889 Acc: 0.8734 Uncertainty_mean: 0.8009 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.3698 Acc: 0.8806 Uncertainty_mean: 0.8087 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.3542 Acc: 0.8843 Uncertainty_mean: 0.8465 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.3383 Acc: 0.8902 Uncertainty_mean: 0.8151 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.3191 Acc: 0.8977 Uncertainty_mean: 0.7861 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.3048 Acc: 0.9012 Uncertainty_mean: 0.7790 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.2913 Acc: 0.9069 Uncertainty_mean: 0.7947 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth

Training complete in 49m 27s
Best Acc: 0.906920 Best Uncertainty: 0.742785
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth
DEBUG
tensor(5927, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.5927
Uncertainty: 0.8068784475326538
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth
DEBUG
tensor(6733, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.6733
Uncertainty: 0.7560150623321533
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth
DEBUG
tensor(7058, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7058
Uncertainty: 0.7432006597518921
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth
DEBUG
tensor(7332, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7332
Uncertainty: 0.7223833799362183
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth
DEBUG
tensor(7446, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7446
Uncertainty: 0.7271167039871216
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth
DEBUG
tensor(7621, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7621
Uncertainty: 0.7139389514923096
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth
DEBUG
tensor(7709, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7709
Uncertainty: 0.7129487991333008
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth
DEBUG
tensor(7783, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7783
Uncertainty: 0.7077626585960388
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth
DEBUG
tensor(7861, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7861
Uncertainty: 0.7159767746925354
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth
DEBUG
tensor(7922, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7922
Uncertainty: 0.7144100069999695
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth
DEBUG
tensor(7950, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7950
Uncertainty: 0.7144337296485901
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth
DEBUG
tensor(7958, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.7958
Uncertainty: 0.7096400260925293
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth
DEBUG
tensor(8027, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8027
Uncertainty: 0.716524600982666
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth
DEBUG
tensor(8052, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8052
Uncertainty: 0.7167218923568726
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth
DEBUG
tensor(8097, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8097
Uncertainty: 0.709185004234314
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth
DEBUG
tensor(8106, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8106
Uncertainty: 0.7133739590644836
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth
DEBUG
tensor(8121, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8121
Uncertainty: 0.709036111831665
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth
DEBUG
tensor(8134, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8134
Uncertainty: 0.7188654541969299
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth
DEBUG
tensor(8158, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8158
Uncertainty: 0.7219557762145996
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth
DEBUG
tensor(8163, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8163
Uncertainty: 0.7192028760910034
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth
DEBUG
tensor(8200, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8200
Uncertainty: 0.717140257358551
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth
DEBUG
tensor(8201, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8201
Uncertainty: 0.7237801551818848
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth
DEBUG
tensor(8198, device='cuda:0')
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth
DEBUG
tensor(8174, device='cuda:0')
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth
DEBUG
tensor(8190, device='cuda:0')
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth
DEBUG
tensor(8456, device='cuda:0')

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8456
Uncertainty: 0.6088347434997559
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth
Traceback (most recent call last):
  File "codebase/main.py", line 273, in <module>
  File "codebase/main.py", line 270, in main
    if __name__ == "__main__":
  File "codebase/main.py", line 266, in runExperiments
    print("DONE with all expretiments")
  File "codebase/main.py", line 111, in CIFAR100_coarse_AND_fine
    print("COARSE END\n")
  File "codebase/main.py", line 87, in defineExperiment
    val_acc_hist, uncertainty_histry = eval_model(modelList, test_dataloader, model_directory ,device, num_classes = num_test_classes, hierarchicalModelPathList =hierarchicalModelPathList , train_dataloader= train_dataloader , test_dataloader =test_dataloader)
  File "/home/user/experiments/codebase/eval.py", line 180, in eval_model
    wasBestModel_byUncertainy = False
  File "/home/user/experiments/codebase/eval.py", line 110, in calculate_results
    inputs = inputs.to(device)
KeyboardInterrupt
