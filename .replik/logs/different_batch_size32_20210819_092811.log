running...
Downloading: "https://download.pytorch.org/models/resnet18-5c106cde.pth" to /home/user/.cache/torch/checkpoints/resnet18-5c106cde.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 18%|█▊        | 8.06M/44.7M [00:00<00:00, 84.2MB/s] 38%|███▊      | 16.9M/44.7M [00:00<00:00, 89.4MB/s] 58%|█████▊    | 25.8M/44.7M [00:00<00:00, 90.8MB/s] 77%|███████▋  | 34.4M/44.7M [00:00<00:00, 90.6MB/s] 97%|█████████▋| 43.2M/44.7M [00:00<00:00, 91.2MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 89.0MB/s]Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
COARSE START

im using:cuda:0
Epoch 0/24
----------

Loss: 1.0668 Acc: 0.6600 Uncertainty_mean: 0.7635 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.5990 Acc: 0.8035 Uncertainty_mean: 0.7830 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.4251 Acc: 0.8595 Uncertainty_mean: 0.8289 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.2941 Acc: 0.9020 Uncertainty_mean: 0.7088 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.1993 Acc: 0.9343 Uncertainty_mean: 0.7157 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.1312 Acc: 0.9561 Uncertainty_mean: 0.7526 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.0880 Acc: 0.9708 Uncertainty_mean: 0.7908 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.0638 Acc: 0.9789 Uncertainty_mean: 0.6805 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.0481 Acc: 0.9848 Uncertainty_mean: 0.7049 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.0419 Acc: 0.9856 Uncertainty_mean: 0.7168 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.0381 Acc: 0.9872 Uncertainty_mean: 0.6539 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.0309 Acc: 0.9897 Uncertainty_mean: 0.7309 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0295 Acc: 0.9902 Uncertainty_mean: 0.7249 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0286 Acc: 0.9900 Uncertainty_mean: 0.6557 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0278 Acc: 0.9904 Uncertainty_mean: 0.7545 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0244 Acc: 0.9918 Uncertainty_mean: 0.6261 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0211 Acc: 0.9928 Uncertainty_mean: 0.6933 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0240 Acc: 0.9920 Uncertainty_mean: 0.6840 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Loss: 0.0219 Acc: 0.9929 Uncertainty_mean: 0.6269 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

Epoch 19/24
----------
Loss: 0.0224 Acc: 0.9923 Uncertainty_mean: 0.6287 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth

Epoch 20/24
----------
Loss: 0.0216 Acc: 0.9931 Uncertainty_mean: 0.6371 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth

Epoch 21/24
----------
Loss: 0.0186 Acc: 0.9939 Uncertainty_mean: 0.6742 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth

Epoch 22/24
----------
Loss: 0.0221 Acc: 0.9922 Uncertainty_mean: 0.7431 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth

Epoch 23/24
----------
Loss: 0.0175 Acc: 0.9940 Uncertainty_mean: 0.6663 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth

Epoch 24/24
----------
Loss: 0.0184 Acc: 0.9944 Uncertainty_mean: 0.6362 
Saved: ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth

Training complete in 49m 17s
Best Acc: 0.994440 Best Uncertainty: 0.626109
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/00.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.7777
Uncertainty: 0.7367653846740723
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/01.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8125
Uncertainty: 0.7289799451828003
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/02.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8128
Uncertainty: 0.7024650573730469
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/03.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8255
Uncertainty: 0.7025787234306335
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/04.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8307
Uncertainty: 0.7120352387428284
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/05.pth

BestModel_byAcc ..so far RESULTS:
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8377
Uncertainty: 0.6815953254699707
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/06.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8354
Uncertainty: 0.677899956703186
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/07.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8360
Uncertainty: 0.6709913015365601
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/08.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8328
Uncertainty: 0.6702800393104553
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/09.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8377
Uncertainty: 0.6609857082366943
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/10.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/11.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8380
Uncertainty: 0.6709989309310913
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/12.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8332
Uncertainty: 0.6453131437301636
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/13.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8354
Uncertainty: 0.6147018671035767
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/14.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/15.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/16.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/17.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/18.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8390
Uncertainty: 0.6246250867843628
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/19.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/20.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/21.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8301
Uncertainty: 0.6079895496368408
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/22.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/23.pth
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/24.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8362
Uncertainty: 0.6025112867355347
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth

BestModel_byAcc ..so far RESULTS:
Results for this epoch: 
Acc: 0.8456
Uncertainty: 0.6088347434997559
Loading model ./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth
BestModel_byUncertainty ..so far  RESULTS: 

Results for this epoch: 
Acc: 0.8277
Uncertainty: 0.5398092269897461
Saved the best model by Accuracy after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byAcc.pth 

Saved the best model by Uncertainty after eval./results/models/ResNet18CIFAR100_coarse_labels_crossEntropyPretrained/best_model_byUncertainty.pth 

Best Acc: 0.845600 Best uncertainty_mean: 0.5398092269897461 


Validation complete in 4m 34s
COARSE END

FINE START

im using:cuda:0
Epoch 0/24
----------
Loss: 1.7152 Acc: 0.5451 Uncertainty_mean: 0.9316 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/00.pth

Epoch 1/24
----------
Loss: 0.8880 Acc: 0.7314 Uncertainty_mean: 0.9357 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/01.pth

Epoch 2/24
----------
Loss: 0.6502 Acc: 0.7964 Uncertainty_mean: 0.9430 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/02.pth

Epoch 3/24
----------
Loss: 0.4788 Acc: 0.8481 Uncertainty_mean: 0.9621 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/03.pth

Epoch 4/24
----------
Loss: 0.3446 Acc: 0.8896 Uncertainty_mean: 0.9282 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/04.pth

Epoch 5/24
----------
Loss: 0.2444 Acc: 0.9222 Uncertainty_mean: 0.9665 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/05.pth

Epoch 6/24
----------
Loss: 0.1715 Acc: 0.9463 Uncertainty_mean: 0.9555 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/06.pth

Epoch 7/24
----------
Loss: 0.1220 Acc: 0.9620 Uncertainty_mean: 0.9283 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/07.pth

Epoch 8/24
----------
Loss: 0.0915 Acc: 0.9714 Uncertainty_mean: 0.9654 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/08.pth

Epoch 9/24
----------
Loss: 0.0684 Acc: 0.9795 Uncertainty_mean: 0.9261 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/09.pth

Epoch 10/24
----------
Loss: 0.0570 Acc: 0.9827 Uncertainty_mean: 0.9488 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/10.pth

Epoch 11/24
----------
Loss: 0.0467 Acc: 0.9863 Uncertainty_mean: 0.9468 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/11.pth

Epoch 12/24
----------
Loss: 0.0404 Acc: 0.9881 Uncertainty_mean: 0.9424 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/12.pth

Epoch 13/24
----------
Loss: 0.0385 Acc: 0.9884 Uncertainty_mean: 0.9335 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/13.pth

Epoch 14/24
----------
Loss: 0.0350 Acc: 0.9896 Uncertainty_mean: 0.9428 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/14.pth

Epoch 15/24
----------
Loss: 0.0313 Acc: 0.9902 Uncertainty_mean: 0.9480 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/15.pth

Epoch 16/24
----------
Loss: 0.0329 Acc: 0.9893 Uncertainty_mean: 0.9580 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/16.pth

Epoch 17/24
----------
Loss: 0.0270 Acc: 0.9914 Uncertainty_mean: 0.9489 
Saved: ./results/models/ResNet18CIFAR100_fine_labels_crossEntropyPretrained/17.pth

Epoch 18/24
----------
Traceback (most recent call last):
  File "codebase/main.py", line 271, in <module>
    
  File "codebase/main.py", line 268, in main
    print("DONE with all expretiments")
  File "codebase/main.py", line 264, in runExperiments
    #defineExperiment(modelList, criterion_name="crossEntropy", optimizer=optimizer, train_dataloader=dataloaders["OFFICE_A_TRAIN"], num_train_classes =31 , test_dataloader=dataloaders["OFFICE_A_TEST"], num_test_classes=31 ,train=True, pretrained =True)
  File "codebase/main.py", line 117, in CIFAR100_coarse_AND_fine
    model, optimizer = resnet18Init(num_train_classes = 100 , pretrained=True)
  File "codebase/main.py", line 78, in defineExperiment
    #Train
  File "/home/user/experiments/codebase/train.py", line 33, in train_model
    inputs = inputs.to(device)
KeyboardInterrupt
